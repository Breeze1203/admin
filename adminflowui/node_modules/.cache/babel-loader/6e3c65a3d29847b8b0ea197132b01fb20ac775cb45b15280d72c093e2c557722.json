{"ast":null,"code":"import menu_request from \"@/api/menu\";\nimport { mapState } from \"vuex\";\nimport { ElMessage } from \"element-plus\";\nimport store from \"@/store\";\nexport default {\n  data() {\n    return {\n      tableData: [],\n      menu: {\n        menu_id: null,\n        menu_name: null,\n        parent_id: null,\n        menu_path: null,\n        menu_role: null,\n        icon: null\n      },\n      update_menu: false,\n      icons: [],\n      parent_id: null,\n      menus: ['一级菜单', '二级菜单'],\n      menus_role: []\n    };\n  },\n  computed: {\n    ...mapState([\"permissions_data\"])\n  },\n  methods: {\n    //初始化所有菜单图标\n    initAllIcons() {\n      menu_request.getIcons().then(resp => {\n        this.icons = resp.data;\n      });\n    },\n    // 获取所有菜单\n    initMenus() {\n      menu_request.getAllMenus().then(resp => {\n        this.tableData = resp.data;\n      });\n    },\n    // 获取所有菜单角色\n    initMenuRole() {\n      menu_request.getParentMenu().then(resp => {\n        this.menus_role = resp.data;\n      });\n    },\n    // 修改菜单\n    updateMenu(data) {\n      this.update_menu = true;\n      this.menu.menu_role = data.menu_role;\n      this.menu.menu_id = data.menu_id;\n      this.menu.parent_id = data.parent_id;\n      this.menu.menu_path = data.path;\n      this.menu.icon = data.icon;\n      this.menu.menu_name = data.menu_name;\n    },\n    // 取消修改\n    cancelUpdate() {\n      this.empty();\n      this.update_menu = false;\n    },\n    // 确认修改\n    sureUpdate() {\n      menu_request.updateMenu(this.menu).then(resp => {\n        if (resp.data.code == 200) {\n          ElMessage.success(resp.data.message);\n          this.initMenus();\n          menu_request.getMenusByRole(JSON.parse(sessionStorage.getItem(\"user\")).id).then(resp => {\n            store.commit(\"initMenu\", resp.data);\n          });\n          this.cancelUpdate();\n        } else {\n          ElMessage.error(resp.data.message);\n        }\n      });\n    },\n    empty() {\n      this.menu.parent_id = null;\n      this.menu.menu_id = null;\n      this.menu.menu_path = null;\n      this.menu.icon = null;\n      this.menu.menu_name = null;\n      this.menus_role = null;\n    }\n  },\n  watch: {\n    parent_id(newValue, oldValue) {\n      if (newValue == null || newValue == '') {\n        this.menu.menu_role = '一级菜单';\n        this.menu.menu_path = '/system';\n      } else {\n        this.menu.menu_role = '二级级菜单';\n        this.menu.menu_path = null;\n      }\n    }\n  },\n  mounted() {\n    this.initMenus();\n    this.initMenuRole();\n    this.initAllIcons();\n  }\n};","map":{"version":3,"names":["menu_request","mapState","ElMessage","store","data","tableData","menu","menu_id","menu_name","parent_id","menu_path","menu_role","icon","update_menu","icons","menus","menus_role","computed","methods","initAllIcons","getIcons","then","resp","initMenus","getAllMenus","initMenuRole","getParentMenu","updateMenu","path","cancelUpdate","empty","sureUpdate","code","success","message","getMenusByRole","JSON","parse","sessionStorage","getItem","id","commit","error","watch","newValue","oldValue","mounted"],"sources":["/Users/pt/Documents/code/adminflowui/src/components/set/MenuSet.vue"],"sourcesContent":["<template>\n  <div class=\"shadow\">\n    <el-row :gutter=\"6\" style=\"margin-bottom: 30px\">\n      <el-col :xs=\"4\" :sm=\"6\" :md=\"4\" :lg=\"3\" :xl=\"1\"\n      ><span>菜单名称:</span></el-col>\n      <el-col :xs=\"2\" :sm=\"3\" :md=\"5\" :lg=\"5\" :xl=\"7\"\n      >\n        <el-input v-model=\"menu.menu_name\" placeholder=\"请输入菜单名称\"/>\n      </el-col>\n      <el-col :xs=\"4\" :sm=\"6\" :md=\"4\" :lg=\"3\" :xl=\"1\"\n      ><span>菜单路径:</span></el-col>\n      <el-col :xs=\"2\" :sm=\"3\" :md=\"5\" :lg=\"9\" :xl=\"7\"\n      >\n        <el-input v-model=\"menu.menu_path\" placeholder=\"请输入菜单路径\">\n          <template #prepend>/system</template>\n        </el-input>\n      </el-col>\n    </el-row>\n    <el-row :gutter=\"6\" style=\"margin-bottom: 30px\">\n      <el-col :xs=\"4\" :sm=\"6\" :md=\"4\" :lg=\"3\" :xl=\"1\"\n      ><span>父级菜单:</span></el-col>\n      <el-col :xs=\"2\" :sm=\"3\" :md=\"5\" :lg=\"5\" :xl=\"7\">\n        <el-select :clearable=\"true\" v-model=\"parent_id\" placeholder=\"请选择父级菜单\">\n          <el-option\n              v-for=\"(item,index) in menus_role\"\n              :key=\"index\"\n              :label=\"item.menu_name\"\n              :value=\"item.menu_id\"\n          />\n        </el-select>\n      </el-col>\n      <el-col :xs=\"4\" :sm=\"6\" :md=\"4\" :lg=\"3\" :xl=\"1\"\n      ><span>菜单角色:</span></el-col>\n      <el-col :xs=\"2\" :sm=\"3\" :md=\"5\" :lg=\"5\" :xl=\"7\">\n        <el-select :disabled=\"true\" :clearable=\"true\" v-model=\"menu.menu_role\" placeholder=\"请选择菜单角色\">\n          <el-option\n              v-for=\"item in menus\"\n              :key=\"item\"\n              :label=\"item\"\n              :value=\"item\"\n          />\n        </el-select>\n      </el-col>\n      <el-col :xs=\"4\" :sm=\"6\" :md=\"4\" :lg=\"3\" :xl=\"1\"\n      ><span>菜单图标:</span></el-col>\n      <el-col :xs=\"2\" :sm=\"3\" :md=\"5\" :lg=\"5\" :xl=\"7\">\n        <el-select :clearable=\"true\" v-model=\"menu.icon\" placeholder=\"请选择菜单图标\">\n          <el-option\n              v-for=\"item in icons\"\n              :key=\"item\"\n              :label=\"item\"\n              :value=\"item\"\n          />\n        </el-select>\n      </el-col>\n    </el-row>\n    <el-row :gutter=\"6\" style=\"margin-bottom: 30px\">\n      <el-col :xs=\"4\" :sm=\"6\" :md=\"4\" :lg=\"3\" :xl=\"1\">\n        <el-button type=\"primary\" plain icon=\"Search\">搜索</el-button>\n      </el-col>\n      <el-col :xs=\"2\" :sm=\"3\" :md=\"5\" :lg=\"5\" :xl=\"7\">\n        <el-button plain icon=\"Refresh\" @click=\"initMenus\">刷新</el-button>\n      </el-col>\n      <el-col :xs=\"2\" :sm=\"3\" :md=\"5\" :lg=\"5\" :xl=\"7\">\n        <el-button :disabled=\"!permissions_data.includes('export_data')\" plain type=\"success\" icon=\"Upload\">导出\n        </el-button>\n      </el-col>\n    </el-row>\n    <el-table\n        :data=\"tableData\"\n        style=\"width: 100%;margin-bottom: 20px;\"\n        row-key=\"menu_id\"\n        border\n        :default-expand-all=\"false\"\n        :tree-props=\"{children: 'menus'}\">\n      <el-table-column align=\"center\" prop=\"menu_id\" label=\"唯一标识\" width=\"100\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"menu_name\" label=\"菜单名称\" width=\"180\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"parent_id\" label=\"父级菜单\" width=\"100\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"path\" label=\"路径\" width=\"180\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"menu_role\" label=\"菜单角色\" width=\"180\"></el-table-column>\n      <el-table-column align=\"center\" label=\"图标\" width=\"150\">\n        <template #default=\"scope\">\n          <el-icon>\n            <component :is=\"scope.row.icon\"/>\n          </el-icon>\n        </template>\n      </el-table-column>\n      <el-table-column fixed=\"right\" align=\"center\" label=\"操作\" width=\"200\">\n        <template #default=\"scope\">\n          <el-button icon=\"Edit\" type=\"text\" :disabled=\"!permissions_data.includes('update_menu')\"\n                     @click=\"updateMenu(scope.row)\">修改菜单\n          </el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n  <el-dialog\n      v-model=\"update_menu\"\n      title=\"修改菜单\"\n      style=\"margin-top: 12%\"\n      width=\"28%\"\n  >\n    <el-row>\n      <el-col :span=\"5\">\n        <span>菜单名称：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-input style=\"width:200px\" v-model=\"menu.menu_name\" size=\"small\"/>\n      </el-col>\n    </el-row>\n    <el-row>\n      <el-col :span=\"5\">\n        <span>父级菜单：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-input disabled style=\"width:200px\" v-model=\"menu.parent_id\" size=\"small\"/>\n      </el-col>\n    </el-row>\n    <el-row style=\"margin-top: 10px\">\n      <el-col :span=\"5\">\n        <span>菜单角色：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-select disabled v-model=\"menu.menu_role\" style=\"width:200px\" placeholder=\"请选择菜单角色\" size=\"small\">\n          <el-option\n              v-for=\"item in menus\"\n              :key=\"item\"\n              :label=\"item\"\n              :value=\"item\"\n          />\n        </el-select>\n      </el-col>\n    </el-row>\n    <el-row style=\"margin-top: 10px\">\n      <el-col :span=\"5\">\n        <span>菜单路径：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-input disabled style=\"width:200px\" v-model=\"menu.menu_path\" size=\"small\"/>\n      </el-col>\n    </el-row>\n    <el-row style=\"margin-top: 10px\">\n      <el-col :span=\"5\">\n        <span>菜单图标：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-input style=\"width:200px\" v-model=\"menu.icon\" size=\"small\"/>\n      </el-col>\n    </el-row>\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"cancelUpdate\">取消</el-button>\n        <el-button type=\"primary\" :disabled=\"!permissions_data.includes('update_menu')\" @click=\"sureUpdate\">\n          确定\n        </el-button>\n      </span>\n    </template>\n  </el-dialog>\n</template>\n<script>\nimport menu_request from \"@/api/menu\";\nimport {mapState} from \"vuex\";\nimport {ElMessage} from \"element-plus\";\nimport store from \"@/store\";\n\nexport default {\n  data() {\n    return {\n      tableData: [],\n      menu: {\n        menu_id: null,\n        menu_name: null,\n        parent_id: null,\n        menu_path: null,\n        menu_role: null,\n        icon: null\n      },\n      update_menu: false,\n      icons: [],\n      parent_id: null,\n      menus: ['一级菜单', '二级菜单'],\n      menus_role: []\n    }\n  },\n  computed: {\n    ...mapState([\"permissions_data\"])\n  },\n  methods: {\n    //初始化所有菜单图标\n    initAllIcons() {\n      menu_request.getIcons().then(resp => {\n        this.icons = resp.data;\n      })\n    },\n    // 获取所有菜单\n    initMenus() {\n      menu_request.getAllMenus().then(resp => {\n        this.tableData = resp.data;\n      })\n    },\n    // 获取所有菜单角色\n    initMenuRole() {\n      menu_request.getParentMenu().then(resp => {\n        this.menus_role = resp.data;\n      })\n    },\n    // 修改菜单\n    updateMenu(data) {\n      this.update_menu = true;\n      this.menu.menu_role=data.menu_role;\n      this.menu.menu_id = data.menu_id;\n      this.menu.parent_id = data.parent_id;\n      this.menu.menu_path = data.path;\n      this.menu.icon = data.icon;\n      this.menu.menu_name = data.menu_name;\n    },\n    // 取消修改\n    cancelUpdate() {\n      this.empty();\n      this.update_menu = false;\n    },\n    // 确认修改\n    sureUpdate(){\n      menu_request.updateMenu(this.menu).then(resp=>{\n        if(resp.data.code==200){\n          ElMessage.success(resp.data.message);\n          this.initMenus();\n          menu_request.getMenusByRole(JSON.parse(sessionStorage.getItem(\"user\")).id).then(resp=>{\n            store.commit(\"initMenu\",resp.data);\n          })\n          this.cancelUpdate();\n        }else {\n          ElMessage.error(resp.data.message);\n        }\n      })\n    },\n    empty() {\n      this.menu.parent_id =null;\n      this.menu.menu_id = null;\n      this.menu.menu_path = null;\n      this.menu.icon = null;\n      this.menu.menu_name = null;\n      this.menus_role=null;\n    }\n\n  },\n  watch: {\n    parent_id(newValue, oldValue) {\n      if (newValue == null || newValue == '') {\n        this.menu.menu_role = '一级菜单';\n        this.menu.menu_path = '/system'\n      } else {\n        this.menu.menu_role = '二级级菜单';\n        this.menu.menu_path = null;\n      }\n    }\n  },\n  mounted() {\n    this.initMenus();\n    this.initMenuRole();\n    this.initAllIcons();\n  }\n}\n</script>\n<style scoped>\n.shadow {\n  margin-top: 30px;\n  padding: 20px; /* 设置内边距，可根据需要进行调整 */\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}