{"ast":null,"code":"import organization_request from \"@/api/organization\";\nimport { ElMessage, ElMessageBox } from \"element-plus\";\nexport default {\n  name: \"Department\",\n  data() {\n    return {\n      data: [],\n      organization: {\n        id: null,\n        name: null,\n        parentId: null\n      },\n      OrganizationVisible: false,\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      },\n      options: []\n    };\n  },\n  methods: {\n    // 初始化树形组织\n    initTreeOrganization() {\n      organization_request.getTreeOrganization().then(resp => {\n        this.data = resp.data;\n      });\n    },\n    // 初始化所有组织\n    initAllOrganization() {\n      organization_request.getAllOrganization().then(resp => {\n        console.log(resp.data);\n        this.options = resp.data;\n      });\n    },\n    // 添加组织\n    addOrganization() {\n      if (this.organization.name === null) {\n        ElMessage.error(\"请输入要添加的部门名称\");\n        return;\n      }\n      if (this.organization.parentId === null) {\n        ElMessage.error(\" 请选择父部门\");\n        return;\n      }\n      organization_request.addOrganization(this.organization).then(resp => {\n        if (resp.data.code === 200) {\n          ElMessage.success(resp.data.message);\n          this.initTreeOrganization();\n          this.initAllOrganization();\n        } else {\n          ElMessage.error(resp.data.message);\n        }\n      });\n    },\n    // 删除组织\n    deleteOrganization(data) {\n      ElMessageBox.confirm('此操作将删除【' + data.name + '】部门，是否继续?', 'Warning', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        organization_request.deleteOrganization(data.id).then(resp => {\n          if (resp.data.code === 200) {\n            ElMessage.success(resp.data.message);\n            this.initTreeOrganization();\n            this.initAllOrganization();\n          } else {\n            ElMessage.error(resp.data.message);\n          }\n        });\n      }).catch(() => {\n        ElMessage({\n          type: 'info',\n          message: '取消操作'\n        });\n      });\n    },\n    //修改组织\n    updateOrg(data) {\n      this.OrganizationVisible = true;\n      console.log(data);\n    }\n  },\n  mounted() {\n    this.initTreeOrganization();\n    this.initAllOrganization();\n  }\n};","map":{"version":3,"names":["organization_request","ElMessage","ElMessageBox","name","data","organization","id","parentId","OrganizationVisible","defaultProps","children","label","options","methods","initTreeOrganization","getTreeOrganization","then","resp","initAllOrganization","getAllOrganization","console","log","addOrganization","error","code","success","message","deleteOrganization","confirm","confirmButtonText","cancelButtonText","type","catch","updateOrg","mounted"],"sources":["/Users/pt/Documents/code/adminflowui/src/components/info/Department.vue"],"sourcesContent":["<template>\n  <div style=\"margin-top: 25px;width: 100%\">\n    <div style=\"width: 100%;margin-top:30px;\">\n      <div>\n        <el-input v-model=\"organization.name\" placeholder=\"请输入部门名称\" style=\"width: 200px;margin-left: 20px\"\n                  type=\"text\">\n        </el-input>\n        <el-select v-model=\"organization.parentId\" clearable placeholder=\"请选择所属部门\" size=\"default\"\n                   style=\"margin-left: 30px\">\n          <el-option\n              v-for=\"item in options\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n          />\n        </el-select>\n        <el-button plain style=\"margin-left: 30px\" type=\"primary\" @click=\"addOrganization\">添加组织\n          <el-icon>\n            <Plus/>\n          </el-icon>\n        </el-button>\n        <el-button plain style=\"margin-left: 30px\" type=\"info\" @click=\"initTreeOrganization\">重置\n          <el-icon>\n            <Refresh/>\n          </el-icon>\n        </el-button>\n      </div>\n    </div>\n  </div>\n  <div style=\"margin-top: 3%\">\n    <el-tree :data=\"data\"\n             :default-expand-all=\"true\"\n             :props=\"defaultProps\"\n             auto-expand-parent\n             class=\"custom-tree\"\n             node-key=\"id\"\n             style=\"width: 90%;font-style: italic\">\n      <template #default=\"{ node, data }\">\n        <div class=\"department\">\n          <span>{{ node.label }}</span>\n          <span class=\"buttons\">\n            <el-button size=\"small\" type=\"danger\" @click=\"deleteOrganization(data)\">删除部门</el-button>\n          </span>\n        </div>\n      </template>\n    </el-tree>\n    <el-table\n        :data=\"data\"\n        style=\"width: 90%;margin-bottom: 20px;margin-top: 3%\"\n        row-key=\"id\"\n        :default-expand-all=\"false\"\n        :tree-props=\"{children: 'children'}\">\n      <el-table-column align=\"center\" prop=\"id\" label=\"唯一标识\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"name\" label=\"部门名称\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"parentId\" label=\"所属父部门标识\"></el-table-column>\n      <el-table-column align=\"center\" fixed=\"right\" label=\"操作\">\n        <template #default=\"scope\">\n          <el-button plain type=\"text\" icon=\"Edit\" @click=\"updateOrg(scope.row)\">修改</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n  <el-dialog v-model=\"OrganizationVisible\" style=\"width: 33%\">\n    <el-row>\n      <el-col :span=\"5\">\n        <span>部门名称：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-input style=\"width: 250px\" v-model=\"organization.name\" size=\"small\"/>\n      </el-col>\n    </el-row>\n    <el-row style=\"margin-top: 10px\">\n      <el-col :span=\"5\">\n        <span>所属部门：</span>\n      </el-col>\n      <el-col :span=\"5\">\n        <el-select v-model=\"organization.parentId\" clearable placeholder=\"请选择所属部门\" style=\"width: 250px\">\n        <el-option\n            v-for=\"item in options\"\n            :key=\"item.id\"\n            :label=\"item.name\"\n            :value=\"item.id\"\n        />\n        </el-select>\n      </el-col>\n    </el-row>\n  </el-dialog>\n</template>\n\n<script>\nimport organization_request from \"@/api/organization\";\nimport {ElMessage, ElMessageBox} from \"element-plus\";\n\nexport default {\n  name: \"Department\",\n  data() {\n    return {\n      data: [],\n      organization: {\n        id: null,\n        name: null,\n        parentId: null,\n      },\n      OrganizationVisible:false,\n      defaultProps: {\n        children: 'children',\n        label: 'name'\n      },\n      options: []\n    }\n  },\n  methods: {\n    // 初始化树形组织\n    initTreeOrganization() {\n      organization_request.getTreeOrganization().then(resp => {\n        this.data = resp.data;\n      })\n    },\n    // 初始化所有组织\n    initAllOrganization() {\n      organization_request.getAllOrganization().then(resp => {\n        console.log(resp.data);\n        this.options = resp.data;\n      })\n    },\n    // 添加组织\n    addOrganization() {\n      if (this.organization.name === null) {\n        ElMessage.error(\"请输入要添加的部门名称\");\n        return;\n      }\n      if (this.organization.parentId === null) {\n        ElMessage.error(\" 请选择父部门\");\n        return;\n      }\n      organization_request.addOrganization(this.organization).then(resp => {\n        if (resp.data.code === 200) {\n          ElMessage.success(resp.data.message);\n          this.initTreeOrganization();\n          this.initAllOrganization();\n        } else {\n          ElMessage.error(resp.data.message);\n        }\n      })\n    },\n    // 删除组织\n    deleteOrganization(data) {\n      ElMessageBox.confirm(\n          '此操作将删除【' + data.name + '】部门，是否继续?',\n          'Warning',\n          {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'warning',\n          }\n      )\n          .then(() => {\n            organization_request.deleteOrganization(data.id).then(resp => {\n              if (resp.data.code === 200) {\n                ElMessage.success(resp.data.message);\n                this.initTreeOrganization();\n                this.initAllOrganization();\n              } else {\n                ElMessage.error(resp.data.message);\n              }\n            })\n          })\n          .catch(() => {\n            ElMessage({\n              type: 'info',\n              message: '取消操作',\n            })\n          })\n    },\n    //修改组织\n    updateOrg(data){\n      this.OrganizationVisible=true;\n      console.log(data);\n    }\n  },\n  mounted() {\n    this.initTreeOrganization();\n    this.initAllOrganization();\n  }\n}\n</script>\n\n<style scoped>\n.department {\n  display: flex;\n  justify-content: space-between;\n  width: 100%;\n}\n\n.custom-tree {\n  color: #666666;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}